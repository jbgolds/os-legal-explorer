<!-- Search Filters Component -->
<div class="card bg-base-100 shadow-lg mb-4">
    <div class="card-body p-4">
        <h3 class="card-title text-lg mb-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z" />
            </svg>
            Refine Search
        </h3>

        <div class="collapse collapse-arrow">
            <input type="checkbox" />
            <div class="collapse-title font-medium">
                Advanced Filters
            </div>
            <div class="collapse-content">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="form-control">
                        <label class="label">
                            <span class="label-text">Jurisdiction</span>
                        </label>
                        <select class="select select-bordered w-full" name="jurisdiction" hx-include="closest div">
                            <option value="">All Jurisdictions</option>
                            <option value="F">Federal</option>
                            <option value="S">State</option>
                        </select>
                    </div>

                    <div class="form-control">
                        <label class="label">
                            <span class="label-text">Court</span>
                        </label>
                        <select class="select select-bordered w-full" name="court" hx-include="closest div">
                            <option value="">All Courts</option>
                            <option value="scotus">Supreme Court</option>
                            <option value="ca1">1st Circuit</option>
                            <option value="ca2">2nd Circuit</option>
                            <option value="ca3">3rd Circuit</option>
                            <option value="ca4">4th Circuit</option>
                            <option value="ca5">5th Circuit</option>
                            <option value="ca6">6th Circuit</option>
                            <option value="ca7">7th Circuit</option>
                            <option value="ca8">8th Circuit</option>
                            <option value="ca9">9th Circuit</option>
                            <option value="ca10">10th Circuit</option>
                            <option value="ca11">11th Circuit</option>
                            <option value="cadc">D.C. Circuit</option>
                            <option value="cafc">Federal Circuit</option>
                        </select>
                    </div>

                    <div class="form-control">
                        <label class="label">
                            <span class="label-text">Start Date</span>
                        </label>
                        <input type="date" class="input input-bordered w-full" name="start_date">
                    </div>

                    <div class="form-control">
                        <label class="label">
                            <span class="label-text">End Date</span>
                        </label>
                        <input type="date" class="input input-bordered w-full" name="end_date">
                    </div>

                    <div class="form-control">
                        <label class="label">
                            <span class="label-text">Sort By</span>
                        </label>
                        <select class="select select-bordered w-full" name="order_by" hx-include="closest div">
                            <option value="score desc">Relevance</option>
                            <option value="dateFiled desc">Newest First</option>
                            <option value="dateFiled asc">Oldest First</option>
                            <option value="citeCount desc">Most Cited</option>
                        </select>
                    </div>

                    <div class="form-control">
                        <label class="label">
                            <span class="label-text">Results Per Page</span>
                        </label>
                        <select class="select select-bordered w-full" name="page_size" hx-include="closest div">
                            <option value="10">10</option>
                            <option value="20">20</option>
                            <option value="50">50</option>
                        </select>
                    </div>
                </div>

                <div class="flex justify-end mt-4">
                    <button class="btn btn-primary" hx-get="/api/search" hx-include="closest .card"
                        hx-target="#search-results" hx-indicator="#search-indicator">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24"
                            stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                        </svg>
                        Apply Filters
                    </button>
                </div>
            </div>
        </div>

        <!-- Active Filters -->
        <div class="flex flex-wrap gap-2 mt-4" id="active-filters">
            <!-- These will be populated dynamically based on selected filters -->
        </div>
    </div>
</div>

<!-- JavaScript for handling active filters -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const filterInputs = document.querySelectorAll('select[name], input[name]');
        const activeFiltersContainer = document.getElementById('active-filters');

        // Update active filters display
        function updateActiveFilters() {
            activeFiltersContainer.innerHTML = '';

            filterInputs.forEach(input => {
                if (input.value) {
                    const filterName = input.previousElementSibling.textContent.trim();
                    let filterValue = input.value;

                    // For select elements, get the selected option text
                    if (input.tagName === 'SELECT') {
                        filterValue = input.options[input.selectedIndex].text;
                    }

                    // Create badge for active filter
                    const badge = document.createElement('div');
                    badge.className = 'badge badge-primary gap-2';
                    badge.innerHTML = `
                        ${filterName}: ${filterValue}
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="inline-block w-4 h-4 stroke-current cursor-pointer" data-filter="${input.name}">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    `;

                    // Add click handler to remove filter
                    badge.querySelector('svg').addEventListener('click', function () {
                        const filterName = this.dataset.filter;
                        const input = document.querySelector(`[name="${filterName}"]`);
                        input.value = '';
                        updateActiveFilters();
                    });

                    activeFiltersContainer.appendChild(badge);
                }
            });
        }

        // Add event listeners to all filter inputs
        filterInputs.forEach(input => {
            input.addEventListener('change', updateActiveFilters);
        });

        // Initialize active filters
        updateActiveFilters();
    });
</script>