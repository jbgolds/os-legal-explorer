<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
    <!-- Case Details Panel -->
    <div class="bg-white p-6 rounded shadow">
        <h2 class="text-2xl font-bold">${case.case_name}</h2>
        <div class="text-gray-600">
            <p>${case.court_name}</p>
            <p>Filed: ${format_date(case.date_filed)}</p>
        </div>

        <div class="mt-4">
            <h3 class="font-bold">Summary</h3>
            <p class="text-gray-700">${case.brief_summary}</p>
        </div>

        <div class="mt-4 flex space-x-4">
            <button class="bg-blue-500 text-white px-4 py-2 rounded" hx-get="/case/${case.cluster_id}/text"
                hx-target="#case-content" hx-swap="innerHTML">View Full Text</button>
            <a href="/api/opinions/${case.cluster_id}/text"
                class="bg-green-500 text-white px-4 py-2 rounded inline-block">
                Download
            </a>
        </div>
    </div>

    <!-- Citation Network Visualization -->
    <div class="bg-white p-6 rounded shadow">
        <h2 class="text-xl font-bold mb-4">Citation Network</h2>
        <div id="citation-graph" class="h-80 border border-gray-200 rounded"></div>
    </div>

    <!-- Citations Lists -->
    <div class="md:col-span-2 bg-white p-6 rounded shadow">
        <div class="border-b border-gray-200">
            <nav class="flex -mb-px">
                <button class="py-2 px-4 border-b-2 border-blue-500 font-medium text-blue-600" id="outgoing-tab"
                    hx-get="/case/${case.cluster_id}/citations?direction=outgoing" hx-target="#citations-content"
                    hx-trigger="load, click">
                    Outgoing Citations (${outgoing_count})
                </button>
                <button
                    class="py-2 px-4 border-b-2 border-transparent font-medium text-gray-500 hover:text-gray-700 hover:border-gray-300"
                    id="incoming-tab" hx-get="/case/${case.cluster_id}/citations?direction=incoming"
                    hx-target="#citations-content">
                    Incoming Citations (${incoming_count})
                </button>
            </nav>
        </div>
        <div id="citations-content" class="mt-4">
            <!-- Will be populated by HTMX -->
        </div>
    </div>
</div>

<script>
    // Initialize the citation graph once the data is loaded
    document.addEventListener('htmx:afterOnLoad', function () {
        fetch('/api/citations/network?cluster_id=${case.cluster_id}&depth=1&limit=30')
            .then(response => response.json())
            .then(data => {
                createCitationGraph(data, '#citation-graph');
            });
    });
</script>